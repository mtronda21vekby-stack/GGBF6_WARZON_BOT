# -*- coding: utf-8 -*-
from __future__ import annotations
import re


def parse_player_input(text: str) -> dict:
    """
    –û–∂–∏–¥–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç:
    –†–∞—É–Ω–¥: 18 | –£–º–∏—Ä–∞—é –æ—Ç: —É–∑–∫–æ | –ï—Å—Ç—å: PAP, Jug
    """
    result = {
        "round": None,
        "death": None,
        "have": [],
    }

    if not text:
        return result

    m = re.search(r"—Ä–∞—É–Ω–¥\s*:\s*(\d+)", text, re.IGNORECASE)
    if m:
        result["round"] = int(m.group(1))

    m = re.search(r"—É–º–∏—Ä–∞—é\s*–æ—Ç\s*:\s*([^\|]+)", text, re.IGNORECASE)
    if m:
        result["death"] = m.group(1).strip().lower()

    m = re.search(r"–µ—Å—Ç—å\s*:\s*(.+)", text, re.IGNORECASE)
    if m:
        result["have"] = [x.strip().lower() for x in m.group(1).split(",")]

    return result


def zombie_coach_reply(p: dict) -> str:
    round_ = p.get("round")
    death = p.get("death") or ""
    have = p.get("have") or []

    # -------- –°–ï–ô–ß–ê–° --------
    if "—É–∑–∫–æ" in death:
        now = (
            "üöë –°–ï–ô–ß–ê–°:\n"
            "‚Ä¢ –ù–ï —Å—Ç—Ä–µ–ª—è–π ‚Äî –æ—Å–≤–æ–±–æ–¥–∏ –≤—ã—Ö–æ–¥\n"
            "‚Ä¢ –†–µ–∑–∫–∏–π —à–∞–≥ –≤ —Å—Ç–æ—Ä–æ–Ω—É, –Ω–µ –Ω–∞–∑–∞–¥\n"
            "‚Ä¢ –£–±–µ—Ä–∏ –±–ª–∏–∂–∞–π—à–∏—Ö, –∞ –Ω–µ –¥–∞–ª—å–Ω–∏—Ö"
        )
    elif "—Ç–æ–ª–ø–∞" in death:
        now = (
            "üöë –°–ï–ô–ß–ê–°:\n"
            "‚Ä¢ –ü—Ä–µ–∫—Ä–∞—Ç–∏ —Ñ–∞—Ä–º–∏—Ç—å –æ—á–∫–∏\n"
            "‚Ä¢ –°–æ–±–µ—Ä–∏ –æ—Ä–¥—É –≤ –æ–¥–∏–Ω —Ö–≤–æ—Å—Ç\n"
            "‚Ä¢ –£–±–∏–≤–∞–π —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–æ—Å—Ç–æ—Ä–µ"
        )
    elif "—Å–ø–µ—Ü" in death:
        now = (
            "üöë –°–ï–ô–ß–ê–°:\n"
            "‚Ä¢ –û—á–∏—Å—Ç–∏ –º–µ–ª–æ—á—å –≤–æ–∫—Ä—É–≥\n"
            "‚Ä¢ –í—ã–Ω—É–¥–∏ —Å–ø–µ—Ü-–∑–æ–º–±–∏ –∞—Ç–∞–∫–æ–≤–∞—Ç—å\n"
            "‚Ä¢ –ù–∞–∫–∞–∂–∏ –≤ –æ—Ç–∫–∞—Ç–µ"
        )
    else:
        now = (
            "üöë –°–ï–ô–ß–ê–°:\n"
            "‚Ä¢ –°–æ—Ö—Ä–∞–Ω–∏ –¥–∏—Å—Ç–∞–Ω—Ü–∏—é\n"
            "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å –≤—ã—Ö–æ–¥—ã\n"
            "‚Ä¢ –ü–µ—Ä–µ–∑–∞—Ä—è–¥–∏—Å—å –≤ –ø—Ä–æ—Å—Ç–æ—Ä–µ"
        )

    # -------- –î–ê–õ–¨–®–ï --------
    if round_ is not None:
        if round_ <= 10:
            nxt = (
                "‚û°Ô∏è –î–ê–õ–¨–®–ï:\n"
                "‚Ä¢ –û—Ç–∫—Ä–æ–π –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ\n"
                "‚Ä¢ –£—á–∏—à—å –º–∞—Ä—à—Ä—É—Ç\n"
                "‚Ä¢ –ú–∏–Ω–∏–º—É–º –ø–æ–∫—É–ø–æ–∫"
            )
        elif round_ <= 25:
            nxt = (
                "‚û°Ô∏è –î–ê–õ–¨–®–ï:\n"
                "‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω—ã–π –∫—Ä—É–≥\n"
                "‚Ä¢ 1 —É–ª—É—á—à–µ–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ\n"
                "‚Ä¢ –ó–∞–ø–∞—Å–Ω–æ–π –≤—ã—Ö–æ–¥"
            )
        else:
            nxt = (
                "‚û°Ô∏è –î–ê–õ–¨–®–ï:\n"
                "‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–∞–∂–Ω–µ–µ —É—Ä–æ–Ω–∞\n"
                "‚Ä¢ –ú–∏–Ω–∏–º—É–º —Ä–∏—Å–∫–∞\n"
                "‚Ä¢ –¢–µ—Ä–ø–µ–Ω–∏–µ"
            )
    else:
        nxt = "‚û°Ô∏è –î–ê–õ–¨–®–ï:\n‚Ä¢ –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–π –ø–æ–∑–∏—Ü–∏—é"

    # -------- –û–®–ò–ë–ö–ê --------
    if "pap" in have and "—É–∑–∫–æ" in death:
        err = (
            "‚ùå –ì–õ–ê–í–ù–ê–Ø –û–®–ò–ë–ö–ê:\n"
            "‚Ä¢ –£—Ä–æ–Ω –µ—Å—Ç—å, –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ—Ç\n"
            "‚Ä¢ –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Å—Ç–æ—Ä ‚Äî –ø–æ—Ç–æ–º PAP"
        )
    elif "jug" in have and "—Ç–æ–ª–ø–∞" in death:
        err = (
            "‚ùå –ì–õ–ê–í–ù–ê–Ø –û–®–ò–ë–ö–ê:\n"
            "‚Ä¢ –ù–∞–¥–µ–∂–¥–∞ –Ω–∞ —Ö–ø\n"
            "‚Ä¢ Jug –Ω–µ —Å–ø–∞—Å–∞–µ—Ç –æ—Ç –ø–ª–æ—Ö–æ–π –ø–æ–∑–∏—Ü–∏–∏"
        )
    else:
        err = "‚ùå –ì–õ–ê–í–ù–ê–Ø –û–®–ò–ë–ö–ê:\n‚Ä¢ –ù–µ—Ç –ø–ª–∞–Ω–∞ –æ—Ç—Ö–æ–¥–∞"

    return "\n\n".join([now, nxt, err])
