# app/worlds/bo7/presets.py
# -*- coding: utf-8 -*-
from __future__ import annotations

from typing import Dict, Any


def _p(prof: Dict[str, Any], key: str, default: str) -> str:
    v = (prof or {}).get(key)
    return str(v).strip() if v else default


def _mode_style(diff: str) -> str:
    d = (diff or "Normal").lower()
    if "demon" in d:
        return "DEMON"
    if "pro" in d:
        return "PRO"
    return "NORMAL"


def bo7_role_setup_text(profile: Dict[str, Any]) -> str:
    role = _p(profile, "role", "Flex")
    diff = _p(profile, "difficulty", "Normal")
    style = _mode_style(diff)

    base = (
        "üé≠ BO7 ‚Äî –†–æ–ª—å –∏ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è\n"
        f"–¢–≤–æ—è —Ä–æ–ª—å: {role} | –†–µ–∂–∏–º: {diff}\n\n"
    )

    role_blocks = {
        "Slayer": (
            "‚öîÔ∏è –°–ª—ç–π–µ—Ä:\n"
            "‚Ä¢ –¢—ã –Ω–µ ‚Äú–±–µ–∂–∏–º-—É–º–∏—Ä–∞–µ–º‚Äù, —Ç—ã ‚Äî —Ç–µ–º–ø + —Ç—Ä–µ–π–¥—ã.\n"
            "‚Ä¢ 1‚Äì2 —Ñ—Ä–∞–≥–∞ ‚Üí —Å–º–µ–Ω–∞ –ª–∏–Ω–∏–∏. –ù–µ —Å—Ç–æ–π –∫–∞–∫ –º—É–∑–µ–π–Ω—ã–π —ç–∫—Å–ø–æ–Ω–∞—Ç.\n"
            "‚Ä¢ –ï—Å–ª–∏ –ø–µ—Ä–µ—Å—Ç—Ä–µ–ª–∫–∏ —Ä–∞–≤–Ω—ã–µ ‚Äî –≤—ã–∏–≥—Ä—ã–≤–∞–π –ø–æ–∑–∏—Ü–∏—è–º–∏, –Ω–µ —ç–º–æ—Ü–∏—è–º–∏.\n"
        ),
        "Entry": (
            "üö™ –≠–Ω—Ç—Ä–∏:\n"
            "‚Ä¢ –û—Ç–∫—Ä—ã–≤–∞–µ—à—å —Ñ–∞–π—Ç, –Ω–æ –Ω–µ –¥–∞—Ä–∏—à—å –ø–µ—Ä–≤—ã–π –∫–∏–ª–ª.\n"
            "‚Ä¢ –í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –ø–æ–¥ –∏–Ω—Ñ—É/—Ñ–ª–µ—à/—Å–º–æ—É–∫/—Ç–∏–º–º–µ–π—Ç-–ø—Ä–∏—Ü–µ–ª.\n"
            "‚Ä¢ –¢–≤–æ–π —Å–∫–∏–ª–ª: ‚Äú–∑–∞—à—ë–ª ‚Üí –≤—ã–Ω–µ—Å ‚Üí —É—à—ë–ª‚Äù.\n"
        ),
        "IGL": (
            "üß† IGL:\n"
            "‚Ä¢ –û–¥–∏–Ω –∫–æ–ª–ª –ª—É—á—à–µ –¥–µ—Å—è—Ç–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π.\n"
            "‚Ä¢ –î–∞–π: –∫—É–¥–∞, –∑–∞—á–µ–º, –∫—Ç–æ –ø–µ—Ä–≤—ã–π.\n"
            "‚Ä¢ –¢—ã –Ω–µ –æ–±—è–∑–∞–Ω —Ç–æ–ø-—Ñ—Ä–∞–≥–∞—Ç—å, —Ç—ã –æ–±—è–∑–∞–Ω –Ω–µ –¥–µ–ª–∞—Ç—å —Ç—É–ø—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤.\n"
        ),
        "Support": (
            "üõ° –°–∞–ø–ø–æ—Ä—Ç:\n"
            "‚Ä¢ –¢—ã –≤—ã–∏–≥—Ä—ã–≤–∞–µ—à—å —Ä–∞—É–Ω–¥—ã: —Ç—Ä–µ–π–¥, –∏–Ω—Ñ–∞, —É—Ç–∏–ª–∏—Ç–∏.\n"
            "‚Ä¢ –ù–µ –≥–µ—Ä–æ–π—Å—Ç–≤—É–π: –∂–∏–≤–æ–π —Å–∞–ø–ø–æ—Ä—Ç —Å–∏–ª—å–Ω–µ–µ –º—ë—Ä—Ç–≤–æ–≥–æ ‚Äú–ø–æ—á—Ç–∏ —É–±–∏–ª‚Äù.\n"
            "‚Ä¢ –í—Å–µ–≥–¥–∞ –¥–µ—Ä–∂–∏ –ø–ª–∞–Ω –Ω–∞ —Ä–µ—Ç–µ–π–∫.\n"
        ),
        "Flex": (
            "üåÄ –§–ª–µ–∫—Å:\n"
            "‚Ä¢ –ó–∞–∫—Ä—ã–≤–∞–µ—à—å —Å–ª–∞–±—ã–µ –∑–æ–Ω—ã: –≥–¥–µ –ø—Ä–æ–≤–∞–ª ‚Äî —Ç–∞–º —Ç—ã.\n"
            "‚Ä¢ –ú–µ–Ω—è–µ—à—å —Ç–µ–º–ø: –Ω–∞–¥–æ ‚Äî –∂—ë—Å—Ç–∫–æ, –Ω–∞–¥–æ ‚Äî —É–º–Ω–æ.\n"
            "‚Ä¢ –ì–ª–∞–≤–Ω–æ–µ: –±—ã—Å—Ç—Ä–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—à—å—Å—è.\n"
        ),
    }

    block = role_blocks.get(role, role_blocks["Flex"])

    spice = ""
    if style == "NORMAL":
        spice = "\nüôÇ Normal: –º–∏–Ω–∏–º—É–º —Ö–∞–æ—Å–∞, –º–∞–∫—Å–∏–º—É–º –ø–æ–Ω—è—Ç–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π."
    elif style == "PRO":
        spice = "\nüî• Pro: —Ç–µ–º–ø –≤—ã—à–µ, –Ω–æ —Ä–µ—à–µ–Ω–∏—è –≤—Å—ë —Ä–∞–≤–Ω–æ —á–∏—Å—Ç—ã–µ."
    else:
        spice = "\nüòà Demon: –∏–≥—Ä–∞–µ—à—å –Ω–∞–≥–ª–æ‚Ä¶ –Ω–æ –≤—Å–µ–≥–¥–∞ —Å –≤—ã—Ö–æ–¥–æ–º. –ï—Å–ª–∏ –≤—ã—Ö–æ–¥–∞ –Ω–µ—Ç ‚Äî —Ç—ã –Ω–µ Demon, —Ç—ã –ø–æ–¥–∞—Ä–æ–∫ –≤—Ä–∞–≥—É."

    return base + block + spice


def bo7_aim_sens_text(profile: Dict[str, Any]) -> str:
    inp = _p(profile, "input", "Controller")
    plat = _p(profile, "platform", "PC")
    diff = _p(profile, "difficulty", "Normal")
    style = _mode_style(diff)

    if inp == "KBM":
        return (
            "üéØ BO7 ‚Äî Aim/Sens (KBM)\n"
            f"–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: {plat} | –†–µ–∂–∏–º: {diff}\n\n"
            "–ë–∞–∑–∞:\n"
            "‚Ä¢ DPI: 800 (–∏–ª–∏ 1600)\n"
            "‚Ä¢ –°–µ–Ω—Å–∞: —á—Ç–æ–±—ã —Ç—Ä–µ–∫–∏–Ω–≥ –±—ã–ª —Ä–æ–≤–Ω—ã–π, –±–µ–∑ –¥—Ä–æ–∂–∏\n"
            "‚Ä¢ ADS: —Ñ–∏–∫—Å–∏—Ä—É–π –Ω–∞ –Ω–µ–¥–µ–ª—é\n\n"
            "–ü—Ä–∞–≤–∏–ª–æ:\n"
            "‚Ä¢ –ï—Å–ª–∏ –ø—Ä–æ–º–∞—Ö–∏ –∏–∑-–∑–∞ ‚Äú–ø–µ—Ä–µ–ª—ë—Ç–∞‚Äù ‚Äî -5% sens\n"
            "‚Ä¢ –ï—Å–ª–∏ –Ω–µ —É—Å–ø–µ–≤–∞–µ—à—å –¥–æ–≤–µ—Å—Ç–∏ ‚Äî +3‚Äì7% sens\n\n"
            f"–°—Ç–∏–ª—å {style}:\n"
            "‚Ä¢ NORMAL: —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ç—Ä–µ–∫–∏–Ω–≥\n"
            "‚Ä¢ PRO: –º–∏–∫—Ä–æ–∫–æ—Ä—Ä–µ–∫—Ç + –ø—Ä–µ—Ñ–∞–π—Ä\n"
            "‚Ä¢ DEMON: –±—ã—Å—Ç—Ä—ã–µ –ø–∏–∫–∏ + –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π reset\n"
        )

    return (
        "üéØ BO7 ‚Äî Aim/Sens (Controller)\n"
        f"–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: {plat} | –†–µ–∂–∏–º: {diff}\n\n"
        "–ë–∞–∑–∞:\n"
        "‚Ä¢ Sens: —Å—Ä–µ–¥–Ω—è—è/–≤—ã—Å–æ–∫–∞—è –±–µ–∑ –¥—ë—Ä–≥–∞–Ω—å—è\n"
        "‚Ä¢ Deadzone: –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑ –¥—Ä–∏—Ñ—Ç–∞\n"
        "‚Ä¢ Response curve: –≤—ã–±–µ—Ä–∏ –∏ –¥–µ—Ä–∂–∏ 7 –¥–Ω–µ–π\n\n"
        "–ü—Ä–∞–≤–∏–ª–æ:\n"
        "‚Ä¢ –ï—Å–ª–∏ –Ω–∞ –±–ª–∏–∂–Ω–µ–π —Å—Ä—ã–≤–∞–µ—à—å—Å—è ‚Äî —á—É—Ç—å –Ω–∏–∂–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å\n"
        "‚Ä¢ –ï—Å–ª–∏ –Ω–∞ —Å—Ä–µ–¥–Ω–µ–π –Ω–µ –¥–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ—à—å ‚Äî —á—É—Ç—å –≤—ã—à–µ\n\n"
        f"–°—Ç–∏–ª—å {style}:\n"
        "‚Ä¢ NORMAL: —Å–ø–æ–∫–æ–π–Ω—ã–π –ø—Ä–∏—Ü–µ–ª\n"
        "‚Ä¢ PRO: –±—ã—Å—Ç—Ä–µ–µ –≤—Ö–æ–¥ –≤ —Ç—Ä–µ–∫–∏–Ω–≥\n"
        "‚Ä¢ DEMON: –∞–≥—Ä–µ—Å—Å–∏—è = –∫–æ–Ω—Ç—Ä–æ–ª—å, –∞ –Ω–µ –ø–∞–Ω–∏–∫–∞\n"
    )


def bo7_controller_tuning_text(profile: Dict[str, Any]) -> str:
    plat = _p(profile, "platform", "PC")
    diff = _p(profile, "difficulty", "Normal")
    style = _mode_style(diff)

    return (
        "üéÆ BO7 ‚Äî Controller Tuning\n"
        f"–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: {plat} | –†–µ–∂–∏–º: {diff}\n\n"
        "1) Deadzone:\n"
        "‚Ä¢ Left: –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑ –¥—Ä–∏—Ñ—Ç–∞\n"
        "‚Ä¢ Right: –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑ –¥—Ä–æ–∂–∏\n\n"
        "2) –¢—Ä–µ–∫–∏–Ω–≥:\n"
        "‚Ä¢ –°—Ç—Ä–µ–π—Ñ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏—Ü–µ–ª—É. –°—Ç–æ—è—Ç—å —Å—Ç–æ–ª–±–æ–º ‚Äî –∑–ª–æ.\n\n"
        "3) ADS:\n"
        "‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å 7 –¥–Ω–µ–π > –≤–µ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã.\n\n"
        f"{'üòà Demon: —Ç—ã –¥–æ–ª–∂–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–∞—á—É –Ω–∞ —Ö–æ–¥—É. –ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—à—å ‚Äî —Å–Ω–∏–∑—å sens –∏ —Å—Ç–∞–Ω—å —á–µ–ª–æ–≤–µ–∫–æ–º.' if style=='DEMON' else 'üôÇ –°–æ–≤–µ—Ç: –Ω–µ –º–µ–Ω—è–π 10 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –º–µ–Ω—è–π 1 –∏ –ø—Ä–∏–≤—ã–∫–∞–π.'}\n"
    )


def bo7_kbm_tuning_text(profile: Dict[str, Any]) -> str:
    plat = _p(profile, "platform", "PC")
    diff = _p(profile, "difficulty", "Normal")
    style = _mode_style(diff)

    return (
        "‚å®Ô∏è BO7 ‚Äî KBM Tuning\n"
        f"–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: {plat} | –†–µ–∂–∏–º: {diff}\n\n"
        "1) –°–µ–Ω—Å–∞:\n"
        "‚Ä¢ –û–¥–Ω–∞ –±–∞–∑–∞ –Ω–∞ –Ω–µ–¥–µ–ª—é\n"
        "‚Ä¢ ADS –±–µ–∑ —Å—é—Ä–ø—Ä–∏–∑–æ–≤\n\n"
        "2) –ü–∏–∫–∏:\n"
        "‚Ä¢ 1 –∏–Ω—Ñ–∞ ‚Üí 1 —É—Ä–æ–Ω/–∫–∏–ª–ª ‚Üí —Å–º–µ–Ω–∞ –ø–æ–∑–∏—Ü–∏–∏\n"
        "‚Ä¢ –ù–µ —Ä–µ–ø–∏–∫–∞–π –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —É–≥–æ–ª –¥–≤–∞–∂–¥—ã\n\n"
        f"{'üî• Pro: –ø—Ä–µ—Ñ–∞–π—Ä + –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞.' if style=='PRO' else ('üòà Demon: –ø–∏–∫–Ω–∏ –∏ –∏—Å—á–µ–∑–Ω–∏ ‚Äî –≤—Ç–æ—Ä–æ–π –ø–∏–∫ –æ–±—ã—á–Ω–æ –≤ –ª–æ–±.' if style=='DEMON' else 'üôÇ Normal: —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ —Å–∫–æ—Ä–æ—Å—Ç–∏.')}\n"
    )


def bo7_movement_positioning_text(profile: Dict[str, Any]) -> str:
    diff = _p(profile, "difficulty", "Normal")
    style = _mode_style(diff)

    return (
        "üß† BO7 ‚Äî –ú—É–≤–º–µ–Ω—Ç/–ü–æ–∑–∏—Ü–∏–æ–Ω–∫–∞\n"
        f"–†–µ–∂–∏–º: {diff}\n\n"
        "–°–ï–ô–ß–ê–°:\n"
        "‚Ä¢ –ò–≥—Ä–∞–µ—à—å –ª–∏–Ω–∏—è–º–∏: –≥–¥–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ —É–≥–ª–∞ ‚Äî —Ç–∞–º –∏ —Ç—ã.\n"
        "‚Ä¢ –ü–æ—Å–ª–µ —Ñ—Ä–∞–≥–∞ —Å–º–µ—Å—Ç–∏ —É–≥–æ–ª/–ª–∏–Ω–∏—é (–Ω–µ —Å—Ç–æ–π –Ω–∞ –º–µ—Å—Ç–µ).\n"
        "‚Ä¢ –ï—Å–ª–∏ —Ç—ã ‚Äú–≤ —É–∑–∫–æ–º‚Äù ‚Äî –¥–µ—Ä–∂–∏ –≤—ã—Ö–æ–¥, –Ω–µ –∂–∞–¥–Ω–∏—á–∞–π.\n\n"
        "–î–ê–õ–¨–®–ï:\n"
        "‚Ä¢ –ö–∞–∂–¥—ã–µ 10 —Å–µ–∫ –∑–∞–¥–∞–≤–∞–π —Å–µ–±–µ: ‚Äú–≥–¥–µ –≤—Ä–∞–≥? –≥–¥–µ —É–∫—Ä—ã—Ç–∏–µ? –≥–¥–µ –≤—ã—Ö–æ–¥?‚Äù\n"
        "‚Ä¢ –ò–≥—Ä–∞–π –æ—Ç –∏–Ω—Ñ—ã –∏ —Ç–∞–π–º–∏–Ω–≥–∞, –∞ –Ω–µ –æ—Ç ‚Äú—Ö–æ—á—É –∫–∏–ª–ª‚Äù.\n\n"
        f"{'üòà Demon: –±—ã—Å—Ç—Ä—ã–π —Ç–µ–º–ø ‚Äî —ç—Ç–æ –Ω–µ —Ö–∞–æ—Å. –≠—Ç–æ –ø–æ—Ä—è–¥–æ–∫ –Ω–∞ –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏.' if style=='DEMON' else 'üôÇ –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ª—É—á—à–∏–π –º—É–≤–º–µ–Ω—Ç ‚Äî —ç—Ç–æ —É–º–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è, –∞ –Ω–µ —Ü–∏—Ä–∫.'}\n"
    )


def bo7_audio_visual_text(profile: Dict[str, Any]) -> str:
    diff = _p(profile, "difficulty", "Normal")
    style = _mode_style(diff)

    return (
        "üéß BO7 ‚Äî –ê—É–¥–∏–æ/–í–∏–¥–µ–æ\n"
        f"–†–µ–∂–∏–º: {diff}\n\n"
        "–ê—É–¥–∏–æ:\n"
        "‚Ä¢ –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è: –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ + —ç—Ç–∞–∂ + –¥–∏—Å—Ç–∞–Ω—Ü–∏—è.\n"
        "  (–ø–ª–æ—Ö–æ: ‚Äú–¢–£–¢!!!‚Äù; —Ö–æ—Ä–æ—à–æ: ‚Äú2 —Å–ø—Ä–∞–≤–∞, –≤—Ç–æ—Ä–æ–π —ç—Ç–∞–∂‚Äù) \n"
        "‚Ä¢ –ï—Å–ª–∏ —à—É–º ‚Äî –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–π—Å—è –ø–æ –º–∏–Ω–∏-–∫–∞—Ä—Ç–µ/–º–µ—Ç–∫–∞–º/—Ç—Ä–∞—Å—Å–µ—Ä–∞–º.\n\n"
        "–í–∏–¥–µ–æ:\n"
        "‚Ä¢ –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å —Å–∏–ª—É—ç—Ç–∞ –≤–∞–∂–Ω–µ–µ –∫—Ä–∞—Å–æ—Ç—ã.\n"
        "‚Ä¢ FPS —Å—Ç–∞–±–∏–ª—å–Ω—ã–π > —É–ª—å—Ç—Ä–∞ –≥—Ä–∞—Ñ–∏–∫–∞.\n\n"
        f"{'üî• Pro: –∏–Ω—Ñ–∞ = –≤–∞–ª—é—Ç–∞. –°–Ω–∞—á–∞–ª–∞ –∏–Ω—Ñ–∞, –ø–æ—Ç–æ–º –ø–æ–Ω—Ç—ã.' if style=='PRO' else ('üòà Demon: —Ç—ã –Ω–µ –æ–±—è–∑–∞–Ω —Å–ª—ã—à–∞—Ç—å –≤—Å—ë. –¢—ã –æ–±—è–∑–∞–Ω –ø–æ–Ω–∏–º–∞—Ç—å –ª–æ–≥–∏–∫—É –≤—Ä–∞–≥–∞.' if style=='DEMON' else 'üôÇ Normal: —É–ø—Ä–æ—Å—Ç–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É ‚Äî –∑–Ω–∞—á–∏—Ç –±—ã—Å—Ç—Ä–µ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å.')}\n"
    )
